---
// apps/web/src/pages/index.astro
import Layout from "../layouts/Layout.astro";
import Hero from "../components/home/Hero.astro";
import Services from "../components/home/Services.astro";
import ChooseYourPlan from "../components/home/ChooseYourPlan.astro";
import ServiceArea from "../components/home/ServiceArea.astro";
import WhatWeStandFor from "../components/home/WhatWeStandFor.astro";
import MembershipFinancing from "../components/home/MembershipFinancing.astro";
import CustomerFeedback from "../components/home/CustomerFeedback.astro";

import { getPayload } from "payload";
import config from "evergreen-payload";

const payload = await getPayload({ config });

// Obtener datos de la homepage
const homepage = await payload.findGlobal({
  slug: "homepage",
});

// Obtener configuraciones del sitio
const siteSettings = await payload.findGlobal({
  slug: "site-settings",
});

// Destructure sections
const {
  hero,
  servicesSection,
  chooseYourPlan,
  serviceArea,
  values,
  membership,
  customerFeedback,
  seo,
  schema,
  whatWeStandFor,
  showLogos,
} = homepage;

// Preparar meta tags
const metaTitle =
  seo?.metaTitle ||
  `${siteSettings.company.name} - Professional Plumbing & HVAC Services`;
const metaDescription =
  seo?.metaDescription || siteSettings.seoDefaults.defaultMetaDescription;
const ogImage =
  seo?.ogImage?.url || siteSettings.seoDefaults.defaultOgImage?.url;
---

<section>
  <Hero data={hero} />
  <Services data={servicesSection} />
  <ChooseYourPlan data={chooseYourPlan} />
  <ServiceArea data={serviceArea} />
  <WhatWeStandFor data={whatWeStandFor} />
  <MembershipFinancing data={membership} />
  <CustomerFeedback
    data={customerFeedback}
    class="bg-neutral-50"
    showLogos={showLogos}
  />
</section>
